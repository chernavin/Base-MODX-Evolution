
Andchir

http://modx-shopkeeper.ru

-----------------------------------------

ƒобавлена возможность в параметре &where задавать услови€ выборки (SQL) по TV (до правок было возможно писать услови€ только по таблице "content"). “акже добавлен "mode" - 12 дл€ фильтрации по множественным значени€м полей (документа или TV) с логикой "или".

-----------------------------------------

ѕример:

[[Ditto? &tpl=`dittoChunk`&where=`@SQL: AND (tvc.tmplvarid = '10' AND tvc.value @eq 'значение')`]]

“.е. это дополнительное условие при выборке из Ѕƒ по ID TV (tvc.tmplvarid) и его значению (tvc.value).
@eq - это "ровно" (=). @eq нужно только при вызове сниппета в шаблоне, т.к. парсер не правильно обработает "=". ѕри вызове в PHP можно сразу в строке писать "=", т.е.:

$modx->runSnippet('Ditto', array(
  "tpl" => "dittoChunk",
  "where" => "@SQL: AND (tvc.tmplvarid = '10' AND tvc.value = 'значение')"
));

Ёто полезно дл€ оптимальности, т.к. при &filter фильтраци€ происходит только после того как ¬—≈ документы (по родителю) вытащены из базы. Ёто может быть напр€жно серверу, если документов очень много.

-----------------------------------------

ѕример фильтрации:


[[Ditto? &filter=`tvname,черный~белый~красный,12`]]

¬ыведутс€ только документы, у которых в значени€х TV с именем "tvname" есть указанные значени€, разделенные "~" (остальные отфильтруютс€).

